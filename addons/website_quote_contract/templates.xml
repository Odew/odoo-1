<odoo>
    <template id="quotations" inherit_id="website_portal.quotations">
        <xpath expr="//t[@t-foreach='cust_quotations']" position="replace">
            <t t-foreach="cust_quotations" t-as="quotation">
                <tr>
                    <td>
                        <a t-att-href="'/quote/'+str(quotation.id)"><t t-esc="quotation.name"/></a>
                        <t t-if="quotation.state == 'cancel'">
                            <span class="label label-default"><i class="fa fa-fw fa-remove"/> Cancelled</span>
                        </t>
                    </td>
                    <td><t t-esc="quotation.validity_date"/></td>
                    <td><span t-field="quotation.amount_total" t-field-options='{"widget": "monetary", "display_currency": "quotation.company_id.currency_id"}'/>
                    </td>
                </tr>
            </t>
        </xpath>
    </template>

    <template id="so_quotation" inherit_id="website_quote.so_quotation">
        <xpath expr="//div[@class='row mt16']" position="before">
            <div class="row">
                <div class="col-sm-4">
                    <ol class="breadcrumb mt8">
                        <li><a href="/account">My Account</a></li>
                        <li>
                            Quotation <t t-esc="quotation.name"/>
                        </li>
                    </ol>
                </div>
            </div>
        </xpath>
    </template>

    <template id="contract_pricing" name="Contract Price" inherit_id="website_quote.pricing">
    <xpath expr="//section[@id='quote']" position="after">
      <section id="contract" t-if="quotation.template_id and quotation.template_id.sudo().contract_template">
            <t t-set="contract_template" t-value="quotation.template_id.sudo().contract_template"/>
          <h1 class="page-header">Subscription</h1>
          <p>A new contract will be created from this quotation. The following products will be added to your usual invoice (every <span t-field="contract_template.recurring_interval"/> <span t-field="contract_template.recurring_rule_type"/>).</p>
          <table class="table wq-table">
              <thead>
                  <tr>
                      <th>Products</th>
                      <th>Quantity</th>
                      <th>Taxes</th>
                      <th></th>
                      <th class="text-right">Unit Price</th>
                      <th class="text-right">Price</th>
                      <th></th>
                  </tr>
              </thead>
              <tbody>
                  <tr t-foreach="quotation.order_line" t-as="line">
                    <t t-if="line.product_id.sudo().recurring_invoice">
                           <td>
                              <span t-field="line.name"/>
                          </td>
                          <td>
                              <div id="quote_qty">
                                  <span t-field="line.product_uom_qty"/>
                                  <span t-field="line.product_uom"/>
                              </div>
                          </td>
                          <td>
                              <div t-foreach="line.tax_id" t-as="tax">
                                  <t t-esc="tax.name"/>
                              </div>
                          </td>
                          <td>
                              <strong t-if="line.discount" class="text-info">
                                  <t t-esc="((line.discount % 1) and '%s' or '%d') % line.discount"/>% discount
                              </strong>
                          </td>
                          <td>
                                <div t-field="line.price_unit"
                                    t-field-options='{"widget": "monetary", "display_currency": "quotation.pricelist_id.currency_id"}'
                                    t-att-style="line.discount and 'text-decoration: line-through' or ''"
                                    t-att-class="(line.discount and 'text-danger' or '') + 'text-right'"/>
                                <!-- TODO: apply monetary widget formating -->
                                <div t-if="line.discount">
                                    <t t-esc="'%.2f' % ((1-line.discount / 100.0) * line.price_unit)"/>
                                </div>
                          </td>
                          <td>
                              <div class="text-right"
                                  t-field="line.price_subtotal"
                                  t-field-options='{"widget": "monetary", "display_currency": "quotation.pricelist_id.currency_id"}'/>
                          </td>
                          <td class="text-center">
                              <a t-attf-href="./update_line/#{ line.id }/?order_id=#{ quotation.id }&amp;unlink=True&amp;token=#{ quotation.access_token }" class="mb8 js_update_line_json hidden-print" t-if="line.option_line_id">
                                  <span class="fa fa-trash-o"></span>
                              </a>
                          </td>
                      </t>
                  </tr>
              </tbody>
          </table>
      </section>
  </xpath>
    </template>

</odoo>
