<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <template id="website_sign.items_view" name="Digital Signatures - Items View">
        <form id="sign_doc_items" method="post" t-attf-action="/website_sign/signed/{{signature_request.id}}/{{token}}">
            <div id="signature-field-view">
                <input id="input_signature_request_id" type="hidden" t-att-value="signature_request.id"/>
                <input id="input_attachment_location" type="hidden" t-att-value="'/web/binary/image?model=ir.attachment&amp;field=datas&amp;id=' + str(signature_request.attachment.id)"/>
                <input id="input_field_readonly" type="hidden" t-att-value="readonly"/>
                <input id="input_current_role" type="hidden" t-att-value="role"/>

                <div id="canvas-container">
                    <iframe id="iframe-view"/>
                    <t t-foreach="signature_request.signature_items" t-as="item">
                        <t t-if="item.value">
                            <input type="hidden"
                            t-att-data-item-id="item.id"
                            t-att-data-type="item.type"
                            t-att-data-required="item.required"
                            t-att-data-responsible="item.responsible.id"
                            t-att-data-page="item.page"
                            t-att-data-posx="item.posX"
                            t-att-data-posy="item.posY"
                            t-att-data-width="item.width"
                            t-att-data-height="item.height"
                            t-att-data-item-value-text="item.value[0].text_value"
                            t-att-data-item-value-image="item.value[0].image_value"/>
                        </t>
                        <t t-if="not item.value">
                            <input type="hidden"
                            t-att-data-item-id="item.id"
                            t-att-data-type="item.type"
                            t-att-data-required="item.required"
                            t-att-data-responsible="item.responsible.id"
                            t-att-data-page="item.page"
                            t-att-data-posx="item.posX"
                            t-att-data-posy="item.posY"
                            t-att-data-width="item.width"
                            t-att-data-height="item.height"/>
                        </t>
                    </t>
                </div>
            </div>
        </form>
        <t t-call="website_sign.signature_dialog">
            <t t-set="signer_name" t-value="Name"/>
            <t t-if="current_request_item">
                <t t-set="signer_name" t-value="current_request_item.partner_id.name"/>
            </t> 
        </t>
    </template>
    
	<template t-name="website_sign.items_edit" name="Signature Request - Fields Edition">
		<t t-call="website.layout">
            <div id="signature-field-view" class="container">
            	<h2><strong><t t-esc="signature_request.attachment.name"/></strong> - Signature Request - Fields Edition</h2>
            	<p>
            		<em>Notice that if you leave your document without any fields, the signers will be requested for an unique signature alongside the document.</em>
            	</p>

                <div class="row">
            		<div class="col-md-3">
            			<input id="input_signature_request_id" type="hidden" t-att-value="signature_request.id"/>
            			<input id="input_attachment_location" type="hidden" t-att-value="'/web/binary/image?model=ir.attachment&amp;field=datas&amp;id=' + str(signature_request.attachment.id)"/>

            			<div class="panel panel-default">
                            <div class="panel-heading">
                				<a t-att-href="'/web?#id=' + str(signature_request.id) + '&amp;view_type=form&amp;model=signature.request'" id="signature_fields_save" class="btn btn-primary btn-block fa fa-check">Save</a>
                            </div>
                        </div>
                        <div class="panel panel-default">
                            <h4 class="panel-heading modal-title">Field types</h4>
    	        			<div class="panel-body">
        	        			<p>Double click to add or delete</p>
                                <button data-item-type="signature" type="button" class="field_type_button btn btn-primary btn-block">Signature</button>
                                <button data-item-type="initial" type="button" class="field_type_button btn btn-primary btn-block">Initial</button>
        	        			<button data-item-type="text" type="button" class="field_type_button btn btn-primary btn-block">Text</button>
                                <button data-item-type="textarea" type="button" class="field_type_button btn btn-primary btn-block">Multiline Text</button>
                                <button data-item-type="date" type="button" class="field_type_button btn btn-primary btn-block">Date</button>
                            </div>
    	        		</div>
            		</div>

            		<div id="canvas-container" class="col-md-9">
    	        		<iframe id="iframe-edit"/>
                        <t t-foreach="signature_request.signature_items" t-as="item">
                            <input type="hidden"
                                t-att-data-item-id="item.id"
                                t-att-data-type="item.type"
                                t-att-data-required="item.required"
                                t-att-data-responsible="item.responsible.id"
                                t-att-data-page="item.page"
                                t-att-data-posx="item.posX"
                                t-att-data-posy="item.posY"
                                t-att-data-width="item.width"
                                t-att-data-height="item.height"/>
                        </t>
    	        	</div>

                    <div class="modal fade" id="responsibles_diag" role="dialog" data-toggle="modal" aria-hidden="true">
                        <div class="modal-dialog">
                            <div class="modal-body">
                                <div class="form-group">
                                    <div class="panel panel-default mt16 mb0">
                                        <div class="panel-heading">
                                            <strong>Select the responsible</strong>
                                        </div>
                                        <div class="panel-body">
                                            <button type="button" data-dismiss="modal" data-party="0" class="btn btn-primary btn-block">Everyone</button>
                                            <t t-foreach="signature_item_parties" t-as="signature_item_party">
                                                <button type="button" data-dismiss="modal" t-att-data-party="signature_item_party.id" class="btn btn-primary btn-block"><t t-esc="signature_item_party.name"/></button>
                                            </t>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </t>
	</template>
</odoo>
