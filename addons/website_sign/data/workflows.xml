<?xml version="1.0"?>
<odoo>
	<!-- Signature request workflow -->
	<record model="workflow" id="wkf_signature_request">
        <field name="name">Signature request workflow</field>
        <field name="osv">signature.request</field>
        <field name="on_create">True</field>
    </record>

    <record model="workflow.activity" id="signature_request_draft">
        <field name="name">Draft</field>
        <field name="wkf_id" ref="wkf_signature_request"/>
        <field name="flow_start" eval="True"/>
        <field name="kind">function</field>
        <field name="action">action_draft()</field>
    </record>
    <record model="workflow.activity" id="signature_request_opened">
        <field name="name">Opened</field>
        <field name="wkf_id" ref="wkf_signature_request"/>
        <field name="kind">function</field>
        <field name="action">action_opened()</field>
    </record>
    <record model="workflow.activity" id="signature_request_closed">
        <field name="name">Closed</field>
        <field name="wkf_id" ref="wkf_signature_request"/>
        <field name="kind">function</field>
        <field name="action">action_closed()</field>
    </record>
    <record model="workflow.activity" id="signature_request_canceled">
        <field name="name">Canceled</field>
        <field name="wkf_id" ref="wkf_signature_request"/>
        <field name="kind">function</field>
        <field name="action">action_canceled()</field>
    </record>

    <record model="workflow.transition" id="signature_request_draft_to_opened">
        <field name="act_from" ref="signature_request_draft"/>
        <field name="act_to" ref="signature_request_opened"/>
        <field name="signal">signature_request_launch</field>
    </record>
    <record model="workflow.transition" id="signature_request_draft_to_opened2">
        <field name="act_from" ref="signature_request_draft"/>
        <field name="act_to" ref="signature_request_opened"/>
        <field name="condition">nb_draft == 0</field>
    </record>
    <record model="workflow.transition" id="signature_request_opened_to_draft">
        <field name="act_from" ref="signature_request_opened"/>
        <field name="act_to" ref="signature_request_draft"/>
        <field name="condition">nb_draft > 0</field>
    </record>
    <record model="workflow.transition" id="signature_request_opened_to_closed">
        <field name="act_from" ref="signature_request_opened"/>
        <field name="act_to" ref="signature_request_closed"/>
        <field name="condition">nb_closed == len(request_items)</field>
    </record>
    <record model="workflow.transition" id="signature_request_closed_to_draft">
        <field name="act_from" ref="signature_request_closed"/>
        <field name="act_to" ref="signature_request_draft"/>
        <field name="condition">nb_draft > 0</field>
    </record>
    <record model="workflow.transition" id="signature_request_draft_to_canceled">
        <field name="act_from" ref="signature_request_draft"/>
        <field name="act_to" ref="signature_request_canceled"/>
        <field name="signal">signature_request_cancel</field>
    </record>
    <record model="workflow.transition" id="signature_request_opened_to_canceled">
        <field name="act_from" ref="signature_request_opened"/>
        <field name="act_to" ref="signature_request_canceled"/>
        <field name="signal">signature_request_cancel</field>
    </record>
    <record model="workflow.transition" id="signature_request_closed_to_canceled">
        <field name="act_from" ref="signature_request_closed"/>
        <field name="act_to" ref="signature_request_canceled"/>
        <field name="signal">signature_request_cancel</field>
    </record>
    <record model="workflow.transition" id="signature_request_canceled_to_draft">
        <field name="act_from" ref="signature_request_canceled"/>
        <field name="act_to" ref="signature_request_draft"/>
        <field name="signal">signature_request_draft</field>
    </record>

	<!-- Signature request item workflow -->
	<record model="workflow" id="wkf_signature_request_item">
        <field name="name">Signature request item workflow</field>
        <field name="osv">signature.request.item</field>
        <field name="on_create">True</field>
    </record>

    <record model="workflow.activity" id="signature_request_item_draft">
        <field name="name">Draft</field>
        <field name="wkf_id" ref="wkf_signature_request_item"/>
        <field name="flow_start" eval="True"/>
        <field name="kind">function</field>
        <field name="action">action_draft()</field>
    </record>
    <record model="workflow.activity" id="signature_request_item_opened">
        <field name="name">Opened</field>
        <field name="wkf_id" ref="wkf_signature_request_item"/>
        <field name="kind">function</field>
        <field name="action">action_opened()</field>
    </record>
    <record model="workflow.activity" id="signature_request_item_closed">
        <field name="name">Closed</field>
        <field name="wkf_id" ref="wkf_signature_request_item"/>
        <field name="kind">function</field>
        <field name="action">action_closed()</field>
    </record>

    <record model="workflow.transition" id="signature_request_item_draft_to_opened">
        <field name="act_from" ref="signature_request_item_draft"/>
        <field name="act_to" ref="signature_request_item_opened"/>
        <field name="signal">signature_request_item_launch</field>
    </record>
    <record model="workflow.transition" id="signature_request_item_opened_to_closed">
        <field name="act_from" ref="signature_request_item_opened"/>
        <field name="act_to" ref="signature_request_item_closed"/>
        <field name="signal">signature_request_item_sign</field>
    </record>
    <record model="workflow.transition" id="signature_request_item_opened_to_draft">
        <field name="act_from" ref="signature_request_item_opened"/>
        <field name="act_to" ref="signature_request_item_draft"/>
        <field name="signal">signature_request_item_cancel</field>
    </record>
    <record model="workflow.transition" id="signature_request_item_closed_to_draft">
        <field name="act_from" ref="signature_request_item_closed"/>
        <field name="act_to" ref="signature_request_item_draft"/>
        <field name="signal">signature_request_item_cancel</field>
    </record>
</odoo>
