<?xml version="1.0" encoding="UTF-8"?>
<templates xml:space="preserve">
<t t-name="im_chat.Conversation">
    <div class="oe_im_chatview_header">
        <span class="oe_im_chatview_header_name"></span>
        <span class="oe_im_chatview_nbr_messages"/>
        <span class="oe_im_chatview_right">
            <div class="btn-group oe_im_chatview_option_group">
              <span class="oe_im_chatview_options dropdown-toggle" data-toggle="dropdown">
                <i class="fa fa-cogs"></i>
              </span>
              <ul class="dropdown-menu oe_im_chatview_option_list" role="menu">
                <!-- options -->
              </ul>
            </div>
            <div class="oe_im_chatview_close">Ã—</div>
        </span>
    </div>
    <div class="oe_im_chatview_content">
        <div class="oe_im_chatview_status"/>
        <div class="oe_im_chatview_content_bubbles"></div>
    </div>
    <div class="oe_im_chatview_footer">
        <input class="oe_im_chatview_input" t-att-placeholder="widget.inputPlaceholder" />
    </div>
</t>
<t t-name="im_chat.Conversation_content">
    <t t-foreach="_.keys(list)" t-as="date">
        <div class="oe_im_chatview_date_separator">
            <t t-esc="window.moment(date).format('LL')"/>
        </div>
        <t t-foreach="list[date]" t-as="bubble">
            <t t-if="bubble[0].type === 'message'">
                <t t-call="im_chat.Conversation_message_bubble">
                    <t t-set="messages" t-value="bubble"/>
                </t>
            </t>
            <t t-if="bubble[0].type === 'meta'">
                <t t-call="im_chat.Conversation_technical_bubble">
                    <t t-set="messages" t-value="bubble"/>
                </t>
            </t>
        </t>
    </t>
</t>
<t t-name="im_chat.Conversation_message_bubble">
    <div class="oe_im_chatview_message_bubble">
        <div class="oe_im_chatview_clip">
            <img class="oe_im_chatview_avatar" t-att-src="_.last(messages).from_id[2]"/>
        </div>
        <div class="oe_im_chatview_from"><t t-esc="_.last(messages).from_id[1]"/></div>
        <div class="oe_im_chatview_bubble_list">
            <t t-foreach="messages" t-as="m">
                <div class="oe_im_chatview_bubble_item"><t t-raw="m.message"/></div>
            </t>
        </div>
        <div class="oe_im_chatview_time"><t t-esc="window.moment((_.last(messages).create_date)).format('LT')"/></div>
    </div>
</t>
<t t-name="im_chat.Conversation_technical_bubble">
    <div class="oe_im_chatview_technical_bubble">
        <div class="oe_im_chatview_from"><t t-esc="_.last(messages).from_id[1]"/></div>
        <div>
            <t t-foreach="messages" t-as="m">
                <div><t t-raw="m.message"/></div>
            </t>
        </div>
        <div class="oe_im_chatview_time"><t t-esc="window.moment((_.last(messages).create_date)).format('LT')"/></div>
    </div>
</t>

    <t t-name="im_chat.UserWidget">
        <div class="o_im_chat_user_card row ui-draggable" t-att-title="widget.get('name')">
            <div class="col-md-2">
                <img t-att-src="widget.get('image_url')" class="o_im_chat_avatar" t-att-alt="widget.get('name')"/>
            </div>
            <div class="col-md-10 o_im_chat_user_name">
                <img t-att-src="'/im_chat/static/src/img/green.png'" t-att-data-im-user-id="widget.get('id')" class="pull-right o_im_chat_status"/>
                <t t-esc="widget.get('name')"/>
            </div>
        </div>
    </t>
    <t t-name="im_chat.InstantMessaging">
        <div class="o_im_chat_sidebar">
            <div class="o_im_chat_search">
                <div class="input-group">
                    <input type="text" class="form-control o_im_chat_user_search_box" t-att-placeholder="_t('Search users')"/>
                    <div class="input-group-addon oe_im_search_icon"><i class="fa fa-search"/></div>
                </div>
            </div>
            <div class="oe_im_users o_im_chat_users"></div>
            <div class="o_im_chat_conversations"></div>
        </div>
    </t>
    <t t-name="im_chat.ImTopButton">
        <li t-att-title='_t("Display Instant Messaging")'>
            <a href="#">
                  <i id="oe_topbar_imbutton_icon" class="fa fa-comments-o"/>
            </a>
        </li>
    </t>
</templates>
